task :default => [:build_css, :build_js]

task :build_css do
  system 'sass src/sass/main.sass:public/simple-panorama.css --style compressed'
end

task :compile_coffee do
  modules = Dir['src/coffee/modules/*.coffee'].join(" ")
  output = 'js/compiled_coffee/modules.js'
  if modules == ""
    File.open(output, 'w') {|f| f.write(' ')}
  else
    system "coffee -l -j #{output} -c #{modules}"
  end
  system 'coffee -l -o js/compiled_coffee src/coffee/main.coffee'
end

task :build_js => [:compile_coffee] do
  system 'juicer merge -f -s -o public/simple-panorama.js js/compiled_coffee/main.js'
end